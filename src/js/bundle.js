!function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){e.exports=t(1)},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});class o extends HTMLElement{constructor(){super(),this._mask="",this._correctNumber="+7(985)077-**-**",this._inputsMaskArr=[],this._template=document.createElement("template").innerHTML='\n\n            <style>\n                .phone-module {\n                    display: flex;\n                    flex-wrap: wrap;\n\n                    width: 370px;\n                    height: 50px;\n\n                    font-family: Arial, Helvetica, sans-serif;\n                    color: #333333;\n                    font-size: 20px;\n\n                    justify-content: space-around;\n                }\n\n                .phone-module__number-section {\n                    display: flex;\n                    flex-wrap: wrap;\n\n                    width: 100%;\n                    height: 35px;\n\n                    justify-content: space-around;\n                }\n\n                .phone-module__error-section {\n                    width: 100%;\n\n                    text-align: left;\n                    font-size: 14px;\n                    font-family: Arial, Helvetica, sans-serif;\n                    color: #ff1100;\n                }\n\n                .phone-module__number-section-symbol {\n                    text-align: center;\n                    line-height: 32px;\n\n                    width: 10px;\n                    height: 32px;\n\n                    border: none;\n                }\n\n                .phone-module__number-section-cell {\n                    width: 25px;\n                    height: 32px;\n\n                    text-align: center;\n                    line-height: 32px;\n\n                    background-color: #f0f0f0;\n\n                    margin: 2px;\n                    border-radius: 2px;\n                }\n\n                .phone-module__number-section-input,\n                .phone-module__number-section-input-error,\n                .phone-module__error-section-input-success {\n                    text-align: left;\n                    line-height: 32px;\n\n                    width: 17px;\n                    height: 28px;\n\n                    margin: 2px;\n                    padding-left: 6px;\n\n                    font-family: Arial, Helvetica, sans-serif;\n                    color: #333333;\n                    font-size: 20px;\n\n                    background-color: #ffffff;\n\n                    outline: none;\n\n                    border: 1px solid #f0f0f0;\n                    border-radius: 2px;\n\n                    transition: 0.1s linear;\n                }\n\n                .phone-module__number-section-input-error {\n                    border-color: #ff1100;\n                }\n\n                .phone-module__error-section-input-success {\n                    border-color: #00ff6a;\n                }\n\n                .phone-module__number-section-input:focus {\n                    border: 1px solid #858585;\n                    border-radius: 2px;\n\n                    transition: 0.1s linear;\n                }\n            </style>\n\n            <div class="phone-module">\n                <div class="phone-module__number-section"></div>\n                <div class="phone-module__error-section"></div>\n            </div>\n        ',this.attachShadow({mode:"open"}),this.shadowRoot&&(this.shadowRoot.innerHTML=this._template,this._numberSection=this.shadowRoot.querySelector(".phone-module__number-section"),this._errorSection=this.shadowRoot.querySelector(".phone-module__error-section"))}logic(){if(this._numberSection){let e=1;for(let n=0;n<this._mask.length;n++)switch(this._mask[n]){case"+":case"(":case")":case"-":{const e=document.createElement("div");e.className="phone-module__number-section-symbol",e.innerText=this._mask[n],this._numberSection.appendChild(e);break}case"I":{const t=document.createElement("input");t.className="phone-module__number-section-input",t.id=String(e),t.placeholder="_",this._numberSection.appendChild(t),this._inputsMaskArr.push(n),e++;break}case"*":{const e=document.createElement("div");e.className="phone-module__number-section-cell",e.innerText="•",e.style.fontSize="25px",this._numberSection.appendChild(e);break}case"X":default:{const e=document.createElement("div");e.className="phone-module__number-section-cell",e.innerText=this._mask[n],this._numberSection.appendChild(e);break}}const n=[],t=e;let o;if(this.shadowRoot)for(let t=1;t<=e;t++)(o=this.shadowRoot.getElementById(String(t)))&&n.push(o);const r=new RegExp("^[0-9]+$");for(let e=0;e<t;e++)n[e]&&n[e].addEventListener("input",()=>{n[e].className="phone-module__number-section-input",r.test(n[e].value)?(n[e].value.length>1&&(n[e].value=n[e].value[n[e].value.length-1]),Number(n[e].id)<t-1&&this.shadowRoot&&n[e+1].focus(),"phone-module__number-section-input-error"===n[e].className&&(n[e].className="phone-module__number-section-input")):n[e].value.length>=2?isNaN(Number(n[e].value))?n[e].value=n[e].value[1]:n[e].value=n[e].value[0]:n[e].value=""});this.shadowRoot&&document.addEventListener("keypress",e=>{if(13===e.keyCode){let e=!1;if(this._errorSection){this._errorSection.textContent="";for(let o=0;o<t;o++)if(this.shadowRoot&&n[o]){if(""===n[o].value)return this._errorSection.textContent="Все поля должны быть заполены",void(n[o].className="phone-module__number-section-input-error");n[o].value!==this._correctNumber[this._inputsMaskArr[o]]&&(e=!0)}if(e){for(let e=0;e<t;e++)this.shadowRoot&&n[e]&&(n[e].className="phone-module__number-section-input-error");this._errorSection.textContent="Неверный номер, попробуйте еще раз"}else for(let e=0;e<t;e++)this.shadowRoot&&n[e]&&(n[e].className="phone-module__error-section-input-success")}}})}}set setMask(e){this._mask=e.mask,this.logic()}get getMask(){return this._mask}}n.PhoneValidationComponent=o,customElements.define("phone-validation",o);const r=document.getElementById("7");if(r){const e={mask:"+7(985)0II-**-**"};r.setMask=e}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RzL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiUGhvbmVWYWxpZGF0aW9uQ29tcG9uZW50IiwiSFRNTEVsZW1lbnQiLCJbb2JqZWN0IE9iamVjdF0iLCJzdXBlciIsInRoaXMiLCJfbWFzayIsIl9jb3JyZWN0TnVtYmVyIiwiX2lucHV0c01hc2tBcnIiLCJfdGVtcGxhdGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJhdHRhY2hTaGFkb3ciLCJzaGFkb3dSb290IiwiX251bWJlclNlY3Rpb24iLCJxdWVyeVNlbGVjdG9yIiwiX2Vycm9yU2VjdGlvbiIsImlkIiwibGVuZ3RoIiwiY2VsbCIsImNsYXNzTmFtZSIsImlubmVyVGV4dCIsImFwcGVuZENoaWxkIiwiU3RyaW5nIiwicGxhY2Vob2xkZXIiLCJwdXNoIiwic3R5bGUiLCJmb250U2l6ZSIsImlucHV0c0FyciIsImlucHV0c0NvbCIsImlucHV0IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZyIsIlJlZ0V4cCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0ZXN0IiwiTnVtYmVyIiwiZm9jdXMiLCJpc05hTiIsImV2ZW50Iiwia2V5Q29kZSIsImVyckNoZWNrIiwidGV4dENvbnRlbnQiLCJzZXRNYXNrIiwicHJvcCIsIm1hc2siLCJsb2dpYyIsImdldE1hc2siLCJjdXN0b21FbGVtZW50cyIsImRlZmluZSIsImEiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxHQUFBLENBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsUUFBQSxJQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxZQUFBLENBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVBQUFVLEVBQUFlLEVBQUFFLEVBQUEs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QixZQUFZQyxHQUNSeEMsS0FBS0MsTUFBUXVDLEVBQUtDLEtBQ2xCekMsS0FBSzBDLFFBRVRDLGNBQ0ksT0FBTzNDLEtBQUtDLE9BblNwQnZDLEVBQUFrQywyQkFzU0FnRCxlQUFlQyxPQUFPLG1CQUFvQmpELEdBQzFDLE1BQU1rRCxFQUFJekMsU0FBU3NCLGVBQWUsS0FDbEMsR0FBSW1CLEVBQUcsQ0FDSCxNQUFNcEQsRUFBSSxDQUNOK0MsS0FBTSxvQkFFVkssRUFBRVAsUUFBVTdDIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBpbnRlcmZhY2UgUHJvcHMge1xuICAgIC8qKlxuICAgICAqINCc0LDRgdC60LAg0LjQvdC/0YPRgtCwLiDQl9C90LDRh9C10L3QuNGPOlxuICAgICAqIFwiSVwiIC0g0L7QtNC40L3QvtGH0L3Ri9C5INC40L3Qv9GD0YIg0LTQu9GPINCy0LLQvtC00LAg0L7QtNC90L7QuSDRhtC40YTRgNGLXG4gICAgICogXCJYXCIgLSDRgdC10YDRi9C5INCx0LvQvtC6INGBINGB0LjQvNCy0L7Qu9C+0LwgXCJYXCJcbiAgICAgKiBcIipcIiAtINGB0LXRgNGL0Lkg0LHQu9C+0Log0YEg0YHQuNC80LLQvtC70L7QvCBcIuKXj1wiXG4gICAgICogPNGG0LjRhNGA0LA+IC0g0YHQtdGA0YvQuSDQsdC70L7QuiDRgSDQstCy0LXQtNC10L3QvdC+0Lkg0YbQuNGE0YDQvtC5XG4gICAgICogPNC90LUg0YbQuNGE0YDQsD4gLSDRgdC40LzQstC+0Lsg0L7RgtC+0LHRgNCw0LbQsNC10YLRgdGPIFwi0LrQsNC6INC10YHRgtGMXCJcbiAgICAgKi9cbiAgICBtYXNrOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBQaG9uZVZhbGlkYXRpb25Db21wb25lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgcHJpdmF0ZSBfbWFzayA6IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgX2NvcnJlY3ROdW1iZXIgOiBzdHJpbmcgPSAnKzcoOTg1KTA3Ny0qKi0qKic7XG4gICAgcHJpdmF0ZSBfaW5wdXRzTWFza0FyciA6IG51bWJlcltdID0gW107XG5cbiAgICBwcml2YXRlIF9udW1iZXJTZWN0aW9uISA6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgX2Vycm9yU2VjdGlvbiEgOiBIVE1MRGl2RWxlbWVudDtcblxuICAgIHByaXZhdGUgX3RlbXBsYXRlIDogc3RyaW5nO1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIC8vINCX0LDQtNCw0LXQvCDRiNCw0LHQu9C+0L0sINCyINC60L7RgtC+0YDRi9C5INCx0YPQtNC10YIg0L/QvtC80LXRidC10L0g0LLQsNC70LjQtNC40YDRg9C10LzRi9C5INC90L7QvNC10YBcbiAgICAgICAgdGhpcy5fdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpLmlubmVySFRNTCA9IGBcblxuICAgICAgICAgICAgPHN0eWxlPlxuICAgICAgICAgICAgICAgIC5waG9uZS1tb2R1bGUge1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7XG5cbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDM3MHB4O1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDUwcHg7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IEFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWY7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMzMzMzMzO1xuICAgICAgICAgICAgICAgICAgICBmb250LXNpemU6IDIwcHg7XG5cbiAgICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLnBob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb24ge1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7XG5cbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzVweDtcblxuICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19lcnJvci1zZWN0aW9uIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG5cbiAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogbGVmdDtcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICAgICAgICAgICAgICBmb250LWZhbWlseTogQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICNmZjExMDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLnBob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb24tc3ltYm9sIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMzJweDtcblxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTBweDtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAzMnB4O1xuXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1jZWxsIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDI1cHg7XG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzJweDtcblxuICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAzMnB4O1xuXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmMGYwZjA7XG5cbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAycHg7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDJweDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dCxcbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dC1lcnJvcixcbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19lcnJvci1zZWN0aW9uLWlucHV0LXN1Y2Nlc3Mge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xuICAgICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMzJweDtcblxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTdweDtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAyOHB4O1xuXG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbjogMnB4O1xuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nLWxlZnQ6IDZweDtcblxuICAgICAgICAgICAgICAgICAgICBmb250LWZhbWlseTogQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICMzMzMzMzM7XG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDtcblxuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmO1xuXG4gICAgICAgICAgICAgICAgICAgIG91dGxpbmU6IG5vbmU7XG5cbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2YwZjBmMDtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4O1xuXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb246IDAuMXMgbGluZWFyO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC5waG9uZS1tb2R1bGVfX251bWJlci1zZWN0aW9uLWlucHV0LWVycm9yIHtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjZmYxMTAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC5waG9uZS1tb2R1bGVfX2Vycm9yLXNlY3Rpb24taW5wdXQtc3VjY2VzcyB7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzAwZmY2YTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAucGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dDpmb2N1cyB7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICM4NTg1ODU7XG4gICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDJweDtcblxuICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiAwLjFzIGxpbmVhcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L3N0eWxlPlxuXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGhvbmUtbW9kdWxlXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb25cIj48L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwicGhvbmUtbW9kdWxlX19lcnJvci1zZWN0aW9uXCI+PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6IFwib3BlblwiIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIHRoaXMuc2hhZG93Um9vdC5pbm5lckhUTUwgPSB0aGlzLl90ZW1wbGF0ZTtcbiAgICAgICAgICAgIHRoaXMuX251bWJlclNlY3Rpb24gPSB0aGlzLnNoYWRvd1Jvb3QucXVlcnlTZWxlY3RvcignLnBob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb24nKSBhcyBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuX2Vycm9yU2VjdGlvbiA9IHRoaXMuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKCcucGhvbmUtbW9kdWxlX19lcnJvci1zZWN0aW9uJykgYXMgSFRNTERpdkVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGxvZ2ljKCkgOiB2b2lkIHtcblxuICAgICAgICBpZiAodGhpcy5fbnVtYmVyU2VjdGlvbikge1xuICAgICAgICAgICAgbGV0IGlkID0gMTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INGP0YfQtdC50LrQuCDRgSDRgdC40LzQstC+0LvQsNC80LggLyDQuNC90L/Rg9GC0Ysg0LTQu9GPINCy0LDQu9C40LTQsNGG0LjQuFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9tYXNrLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLl9tYXNrW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICcoJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnKSc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJy0nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9ICdwaG9uZS1tb2R1bGVfX251bWJlci1zZWN0aW9uLXN5bWJvbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmlubmVyVGV4dCA9IHRoaXMuX21hc2tbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9udW1iZXJTZWN0aW9uLmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnSSc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc05hbWUgPSAncGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmlkID0gU3RyaW5nKGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwucGxhY2Vob2xkZXIgPSAnXyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9udW1iZXJTZWN0aW9uLmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5wdXRzTWFza0Fyci5wdXNoKGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJyonOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9ICdwaG9uZS1tb2R1bGVfX251bWJlci1zZWN0aW9uLWNlbGwnO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbC5pbm5lclRleHQgPSAn4oCiJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuc3R5bGUuZm9udFNpemUgPSAnMjVweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9udW1iZXJTZWN0aW9uLmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnWCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NOYW1lID0gJ3Bob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb24tY2VsbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLmlubmVyVGV4dCA9IHRoaXMuX21hc2tbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9udW1iZXJTZWN0aW9uLmFwcGVuZENoaWxkKGNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc05hbWUgPSAncGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1jZWxsJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwuaW5uZXJUZXh0ID0gdGhpcy5fbWFza1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX251bWJlclNlY3Rpb24uYXBwZW5kQ2hpbGQoY2VsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaW5wdXRzQXJyIDogSFRNTElucHV0RWxlbWVudFtdID0gW107XG4gICAgICAgICAgICBjb25zdCBpbnB1dHNDb2wgOiBudW1iZXIgPSBpZDtcbiAgICAgICAgICAgIGxldCBpbnB1dCA6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBpZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0ID0gdGhpcy5zaGFkb3dSb290LmdldEVsZW1lbnRCeUlkKFN0cmluZyhpKSkgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHNBcnIucHVzaChpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJnID0gbmV3IFJlZ0V4cCgnXlswLTldKyQnKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dHNDb2w7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0c0FycltpXSkge1xuICAgICAgICAgICAgICAgICAgICBpbnB1dHNBcnJbaV0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpXS5jbGFzc05hbWUgPSAncGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dCc7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmcudGVzdChpbnB1dHNBcnJbaV0udmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0c0FycltpXS52YWx1ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpXS52YWx1ZSA9IGlucHV0c0FycltpXS52YWx1ZVtpbnB1dHNBcnJbaV0udmFsdWUubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChOdW1iZXIoaW5wdXRzQXJyW2ldLmlkKSkgPCBpbnB1dHNDb2wgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpICsgMV0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dHNBcnJbaV0uY2xhc3NOYW1lID09PSAncGhvbmUtbW9kdWxlX19udW1iZXItc2VjdGlvbi1pbnB1dC1lcnJvcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzQXJyW2ldLmNsYXNzTmFtZSA9ICdwaG9uZS1tb2R1bGVfX251bWJlci1zZWN0aW9uLWlucHV0JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dHNBcnJbaV0udmFsdWUubGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihOdW1iZXIoaW5wdXRzQXJyW2ldLnZhbHVlKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpXS52YWx1ZSA9IGlucHV0c0FycltpXS52YWx1ZVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpXS52YWx1ZSA9IGlucHV0c0FycltpXS52YWx1ZVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0c0FycltpXS52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChldmVudCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXJyQ2hlY2sgOiBib29sZWFuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9lcnJvclNlY3Rpb24pIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Vycm9yU2VjdGlvbi50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXRzQ29sOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dHNBcnJbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5wdXRzQXJyW2ldLnZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lcnJvclNlY3Rpb24udGV4dENvbnRlbnQgPSAn0JLRgdC1INC/0L7Qu9GPINC00L7Qu9C20L3RiyDQsdGL0YLRjCDQt9Cw0L/QvtC70LXQvdGLJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzQXJyW2ldLmNsYXNzTmFtZSA9ICdwaG9uZS1tb2R1bGVfX251bWJlci1zZWN0aW9uLWlucHV0LWVycm9yJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXRzQXJyW2ldLnZhbHVlICE9PSB0aGlzLl9jb3JyZWN0TnVtYmVyW3RoaXMuX2lucHV0c01hc2tBcnJbaV1dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyckNoZWNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVyckNoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0c0NvbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGFkb3dSb290KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0c0FycltpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHNBcnJbaV0uY2xhc3NOYW1lID0gJ3Bob25lLW1vZHVsZV9fbnVtYmVyLXNlY3Rpb24taW5wdXQtZXJyb3InO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lcnJvclNlY3Rpb24udGV4dENvbnRlbnQgPSAn0J3QtdCy0LXRgNC90YvQuSDQvdC+0LzQtdGALCDQv9C+0L/RgNC+0LHRg9C50YLQtSDQtdGJ0LUg0YDQsNC3JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dHNDb2w7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hhZG93Um9vdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dHNBcnJbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRzQXJyW2ldLmNsYXNzTmFtZSA9ICdwaG9uZS1tb2R1bGVfX2Vycm9yLXNlY3Rpb24taW5wdXQtc3VjY2Vzcyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgc2V0IHNldE1hc2socHJvcCA6IFByb3BzKSB7XG4gICAgICAgIHRoaXMuX21hc2sgPSBwcm9wLm1hc2s7XG4gICAgICAgIHRoaXMubG9naWMoKTtcbiAgICB9XG4gICAgZ2V0IGdldE1hc2soKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXNrO1xuICAgIH1cbn1cbmN1c3RvbUVsZW1lbnRzLmRlZmluZShcInBob25lLXZhbGlkYXRpb25cIiwgUGhvbmVWYWxpZGF0aW9uQ29tcG9uZW50KTtcbmNvbnN0IGEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnNycpIGFzIFBob25lVmFsaWRhdGlvbkNvbXBvbmVudDtcbmlmIChhKSB7XG4gICAgY29uc3QgcCA9IHtcbiAgICAgICAgbWFzazogJys3KDk4NSkwSUktKiotKionLFxuICAgIH07XG4gICAgYS5zZXRNYXNrID0gcDtcbiAgICAvLyBhLnJlbmRlcigpO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==